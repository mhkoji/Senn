(defpackage :hachee.kkc
  (:use :cl :hachee.kkc.word)
  (:import-from :alexandria
                :curry)
  (:export :convert
           :lookup
           :make-kkc
           :create-kkc))
(in-package :hachee.kkc)

(defun sentence-words (sentence)
  (mapcar (lambda (form-pron-str)
            ;; A/a-/B/b => form: A-B/ab
            (let ((form-pron-list
                   (mapcar (lambda (form-pron-part-str)
                             (let ((split (cl-ppcre:split
                                           "/"
                                           form-pron-part-str)))
                               (list (or (first split) "")
                                     (or (second split) ""))))
                           (cl-ppcre:split "-" form-pron-str))))
              (make-word
               :form (format nil "窿磲疸狎＇骈蝮骘蝽痱镱扉篝┅吼蝻ㄦ矧磲铋窿磲疸狎＇箦泔钿骘蝽痱镱扉篝┅┅ㄨ徙桢瀹腚惝骈戾后孱翦钽瀛躅轸箦铘孱沐┅ㄤ彐躅怩殪洵溟泗轱钺蝙疳翳钺礤螬戾è溟泗ㄨ徙桢瀹腚惝黠蜾溟泗轱钺蝙喉犭瀛溟泗轱钺蝙┅ㄤ镬轶疳翳钺礤疳翳钺礤溟泗ㄤ镬轶箦铘孱沐ㄨ徙桢瀹腚惝骈戾烘殪瀛倔趄轭绛箦铘孱沐疳翳钺礤┅ㄤ镬轶黠蜾箦铘孱沐黠蜾箦铘孱沐┅ㄨ徙桢瀹腚惝黠蜾溟泗轱钺蝙横滗溟泗黠蜾┅┅溟泗┅ㄤ彐躅怩殪洵鲲汜怩灬蝙疳翳钺礤螬戾è鲲汜ㄨ徙桢瀹腚惝黠蜾鲲汜怩灬蝙喉犭瀛鲲汜怩灬蝙┅ㄤ镬轶疳翳钺礤疳翳钺礤螬ㄤ镬轶箦铘孱沐ㄨ徙桢瀹腚惝骈戾烘殪瀛倔趄轭绛箦铘孱沐疳翳钺礤┅ㄤ镬轶黠蜾箦铘孱沐黠蜾箦铘孱沐┅ㄨ徙桢瀹腚惝黠蜾鲲汜怩灬蝙横滗鲲汜黠蜾┅┅鲲汜猢ㄤ彐躅怩殪洵灬铉踽珏盹溴疳翳钺礤脲鲲汜怩灬蝙戾è麸轭舡矧躅ㄣ躜蝙＇栳汨邋腚惝黠蜾鲲汜怩灬蝙呼锃轭舡矧躅鲲汜怩灬蝙┅孪ㄨ徙桢瀹腚惝黠蜾鲲汜怩灬蝙呼锃轭鲲汜怩灬蝙栳汨邋腚惝黠蜾鲲汜怩灬蝙韩孪荧┅ㄅ嫌ㄨ徙桢瀹腚惝黠蜾鲲汜怩灬蝙呼锃轭鲲汜怩灬蝙栳汨邋腚惝黠蜾鲲汜怩灬蝙韩畔荧┅盹溴磲脲轭篝犷沐ц徙桢瀹灬铉踽珏盹溴飚瞽珧犴喉镤屐┅ㄤ镬轶疳翳钺礤疳翳钺礤螬戾è箦铘孱沐磲疸狎灬礅溽箦铘孱沐ㄨ徙桢瀹灬铉踽珏盹溴旌磲脲箦铘孱沐呼镫孱磲疸狎麸轭舡矧躅箦铘孱沐黠蜾箦铘孱沐┅┅ㄨ徙桢瀹腚惝骈戾烘殪瀛倔趄轭绛箦铘孱沐疳翳钺礤┅┅ㄨ徙桢瀹灬铉踽珏盹溴飚瞽珧犴呼蜥轭盹溴箦铘孱沐郝嫌孪号嫌畔萤┅盹溴飑ㄤ彐篝蝓泗腚筱矧瀛骖溟泗轱钺蝙ㄤ彐躅泸遽翦腚疳翳钺礤螬戾舄è溟泗轱钺蝙ㄢ蹰熹溟泗轱钺蝙疳翳钺礤螬鲲汜怩灬蝙ㄢ蹰熹鲲汜怩灬蝙疳翳钺礤螬灬铉踽珏盹溴ㄢ蹰熹灬铉踽珏盹溴疳翳钺礤忽镢徕蹯狎鲲汜怩灬蝙┅ㄨ徙桢瀹腚愫磲脲腚后泔蝈骖ㄨ徙桢瀹腚惝泔铞弪舢筱矧瀛骖蠛镦黠蜾痱镱忽镢徕蹯狎鲲汜怩灬蝙红犷珲徵瀛盹溴灬铉踽珏盹溴飑轰殂糸镱狎溟泗轱钺蝙┅ㄤ彐躅泔铞弪腚痱镱躅汩狒轱脲斌舡怙躅溽蝙轭溴ㄨ徙桢瀹腚惝泔铞弪艉屮邈豸痱镱躅汩狒轱后泔蝈骖腚悱筱矧瀛骖腚悌轰殂糸镱狎腚悱溟泗轱钺蝙腚悌罕篝怙躅溽蝙轭溴斌舡怙躅溽蝙轭溴┅ㄤ彐躅祜镫躔腚痱镱躅汩狒轱瞟ㄨ徙桢瀹腚惝祜镫躔哄邈豸痱镱躅汩狒轱轰殂糸镱狎腚悱溟泗轱钺蝙腚悌┅