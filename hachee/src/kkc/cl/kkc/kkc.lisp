(defpackage :hachee.kkc
  (:use :cl :hachee.kkc.word)
  (:import-from :alexandria
                :curry)
  (:export :convert
           :lookup
           :profile
           :make-kkc
           :create-kkc
           :save-kkc
           :word-form
           :word-pron))
(in-package :hachee.kkc)

(defun sentence-words (sentence)
  (mapcar (lambda (form-pron-str)
            ;; A/a-/B/b => AB/ab
            (let ((form-pron-list
                   (mapcar (lambda (form-pron-part-str)
                             (let ((split (cl-ppcre:split
                                           "/"
                                           form-pron-part-str)))
                               (list (or (first split) "")
                                     (or (second split) ""))))
                           (cl-ppcre:split "-" form-pron-str))))
              (make-word
               :form (format nil "窿磲疸狎＇骈蝮骘蝽痱镱扉篝┅吼蝻ㄦ矧磲铋窿磲疸狎＇箦泔钿骘蝽痱镱扉篝┅┅ㄨ徙桢瀹腚惝骈戾后孱翦钽瀛躅轸箦铘孱沐┅ㄤ彐躅怩殪洵溟泗轱钺蝙疳翳钺礤螬戾è溟泗ㄨ徙桢瀹腚惝黠蜾溟泗轱钺蝙喉犭瀛溟泗轱钺蝙┅ㄤ镬轶疳翳钺礤疳翳钺礤溟泗ㄤ镬轶箦铘孱沐ㄨ徙桢瀹腚惝骈戾烘殪瀛倔趄轭绛箦铘孱沐疳翳钺礤┅ㄤ镬轶黠蜾箦铘孱沐黠蜾箦铘孱沐┅ㄨ徙桢瀹腚惝黠蜾溟泗轱钺蝙横滗溟泗黠蜾┅┅溟泗┅ㄤ彐躅怩殪洵鲲汜怩灬蝙疳翳钺礤螬戾è鲲汜ㄨ徙桢瀹腚惝黠蜾鲲汜怩灬蝙喉犭瀛鲲汜怩灬蝙┅ㄤ镬轶疳翳钺礤疳翳钺礤螬ㄤ镬轶箦铘孱沐ㄨ徙桢瀹腚惝骈戾烘殪瀛倔趄轭绛箦铘孱沐疳翳钺礤┅ㄤ镬轶黠蜾箦铘孱沐黠蜾箦铘孱沐┅ㄨ徙桢瀹腚惝黠蜾鲲汜怩灬蝙横滗鲲汜黠蜾┅┅鲲汜猢ㄤ彐躅怩殪洵鲲汜怩灬蝙鏖翳躅疳翳钺礤脲秭弪灬博戾è鲲汜ㄨ徙桢瀹腚惝黠蜾鲲汜怩灬蝙喉犭瀛鲲汜怩灬蝙┅黠蜾脲炬蝈磲脲栳箬翎忪呼弩＇羼踽飑┅ㄤ镬轶疳翳钺礤疳翳钺礤螬戾è沲蝌黠蜾磲脲栳箬翎忪呼弩＇羼踽飑┅ㄤ镬轶箦铘孱沐ㄨ徙桢瀹腚惝骈戾烘殪瀛倔趄轭绛箦铘孱沐疳翳钺礤┅ㄤ镬轶黠蜾箦铘孱沐黠蜾箦铘孱沐┅箦翩ㄧ弭栳箬黠蜾倦妁黠蜾沲蝌黠蜾螬黠蜾┅磲痂狍灬礅溽黠蜾脲黠蜾戾è骝羼ㄩ钽ㄧ弭栳箬黠蜾脲黠蜾脲炬蝈癌┅麒孱冀秭弪灬骝羼ㄨ徙桢瀹腚惝黠蜾鲲汜怩灬蝙横滗鲲汜黠蜾┅┅沲蝌黠蜾螬┅鲲汜猢ㄤ彐躅怩殪洵灬铉踽珏盹溴疳翳钺礤脲鲲汜怩灬蝙戾è麸轭舡矧躅ㄣ躜蝙＇栳汨邋腚惝黠蜾鲲汜怩灬蝙呼锃轭舡矧躅鲲汜怩灬蝙┅孪ㄨ徙桢瀹腚惝黠蜾鲲汜怩灬蝙呼锃轭鲲汜怩灬蝙栳汨邋腚惝黠蜾鲲汜怩灬蝙韩孪荧┅ㄅ嫌ㄨ徙桢瀹腚惝黠蜾鲲汜怩灬蝙呼锃轭鲲汜怩灬蝙栳汨邋腚惝黠蜾鲲汜怩灬蝙韩畔荧┅盹溴磲脲轭篝犷沐ц徙桢瀹灬铉踽珏盹溴飚瞽珧犴喉镤屐┅ㄤ镬轶疳翳钺礤疳翳钺礤螬戾è箦铘孱沐磲疸狎灬礅溽箦铘孱沐ㄨ徙桢瀹灬铉踽珏盹溴旌磲脲箦铘孱沐呼镫孱磲疸狎麸轭舡矧躅箦铘孱沐黠蜾箦铘孱沐┅┅ㄨ徙桢瀹腚惝骈戾烘殪瀛倔趄轭绛箦铘孱沐疳翳钺礤┅┅ㄨ徙桢瀹灬铉踽珏盹溴飚瞽珧犴呼蜥轭盹溴箦铘孱沐郝嫌孪号嫌畔萤┅盹溴飑ㄤ彐篝蝓泗腚鲲汜怩灬蝙灬铉踽珏盹溴溟泗轱钺蝙ㄤ彐躅泸遽翦腚疳翳钺礤螬戾舄è溟泗轱钺蝙ㄢ蹰熹溟泗轱钺蝙疳翳钺礤螬鲲汜怩灬蝙ㄢ蹰熹鲲汜怩灬蝙疳翳钺礤螬灬铉踽珏盹溴ㄢ蹰熹灬铉踽珏盹溴疳翳钺礤忽镢徕蹯狎鲲汜怩灬蝙┅ㄨ徙桢瀹腚愫磲脲腚忽镢徕蹯狎鲲汜怩灬蝙红犷珲徵瀛盹溴灬铉踽珏盹溴轰殂糸镱狎溟泗轱钺蝙┅ㄤ彐躅筢鲥腚腚疳翳钺礤轲瑚轸璀秕麴豸麸轲骈戾黩轸弪疳翳钺礤戾è盹溴飙篝蜷铉鏖翳秕麴豸麸篝蜷铉螬ㄨ徙桢瀹灬铉踽珏盹溴飚瞽珧犴后狯瀛盹溴腚悱灬铉踽珏盹溴腚悌螬┅ㄦ戾榄篝蝈犴蠛鏖翳轭瘐舡骝镯箦聃孱沐ㄤ狒岘篝蝈犴ㄦ戾榄篝蝈犴蠛篝蜷铉麸镢翦趔盹溴飙篝蜷铉┅轲瑚蜷翦轲孱趄黩轸弪㈧犷珲徵瀛盹溴飚豇簪溽翎篝蝈犴烘殪瀛黩轸瀛溽翦ㄧ弭躅轹弪筢飙糸礤┅┅┅ㄤ彐躅泔铞弪腚痱镱躅汩狒轱脲斌舡怙躅溽蝙轭溴ㄨ徙桢瀹腚惝泔铞弪艉屮邈豸痱镱躅汩狒轱后泔蝈骖ㄨ徙桢瀹腚惝泔铞弪舢筱矧瀛骖蠛镦骘蝽痱镱忽镢徕蹯狎腚悱鲲汜怩灬蝙腚悌红犷珲徵瀛盹溴腚悱灬铉踽珏盹溴腚悌轰殂糸镱狎腚悱溟泗轱钺蝙腚悌罕篝怙躅溽蝙轭溴斌舡怙躅溽蝙轭溴┅ㄤ彐躅祜镫躔腚痱镱躅汩狒轱瞟ㄨ徙桢瀹腚惝祜镫躔哄邈豸痱镱躅汩狒轱轰殂糸镱狎腚悱溟泗轱钺蝙腚悌┅